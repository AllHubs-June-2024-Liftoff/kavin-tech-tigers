<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friends List</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 20px; }
        .friend-container { width: 50%; margin: auto; }
        .friend { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #ddd; }
        button { background-color: #008CBA; color: white; border: none; padding: 5px 10px; cursor: pointer; }
        button:hover { background-color: #005f73; }
    </style>
</head>
<body>
<h2>My Friends</h2>
<div class="friend-container" id="friends-list">
    <!-- Friends will be loaded here dynamically -->
</div>

<h3>Add a Friend</h3>
<input type="number" id="friendId" placeholder="Enter Friend ID">
<button onclick="addFriend()">Add Friend</button>

<script>
    const userId = 1; // Change this to dynamically fetch the logged-in user ID

    function loadFriends() {
        fetch(`http://localhost:8080/friends/list/${userId}`)
            .then(response => response.json())
            .then(friends => {
                const container = document.getElementById("friends-list");
                container.innerHTML = ""; // Clear existing list

                friends.forEach(friend => {
                    const div = document.createElement("div");
                    div.classList.add("friend");
                    div.innerHTML = `
                        <span>${friend.friend.userName} (${friend.friend.email})</span>
                        <button onclick="removeFriend(${friend.friend.id})">Remove</button>
                    `;
                    container.appendChild(div);
                });
            })
            .catch(error => console.error("Error loading friends:", error));
    }

    function addFriend() {
        const friendId = document.getElementById("friendId").value;
        if (!friendId) return alert("Enter a valid friend ID");

        fetch(`http://localhost:8080/friends/add?userId=${userId}&friendId=${friendId}`, { method: "POST" })
            .then(response => response.json())
            .then(() => {
                alert("Friend added successfully!");
                loadFriends();
            })
            .catch(error => console.error("Error adding friend:", error));
    }

    function removeFriend(friendId) {
        fetch(`http://localhost:8080/friends/remove?userId=${userId}&friendId=${friendId}`, { method: "DELETE" })
            .then(() => {
                alert("Friend removed successfully!");
                loadFriends();
            })
            .catch(error => console.error("Error removing friend:", error));
    }

    loadFriends(); // Load friends when page loads
</script>
</body>
</html>
